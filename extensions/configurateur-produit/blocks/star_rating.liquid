<!-- section-nice-button.liquid -->
<div class="nice-button-container">
  <button id="openPageButton" class="nice-button">Cliquez ici</button>
</div>

<div id="fullPageOverlay" class="hidden-overlay">
  <button id="closePageButton" class="close-button">&times;</button>
  <div class="overlay-content">
    <iframe crossorigin id="monIframe" src="https://frontend-configurateur-emws.vercel.app/" width="800" height="600" style="border:1px solid white; width: 100vw; height: 100vh; overflow: auto;">
    </iframe>
  </div>
</div>

<style>
  /* Bouton principal */
.nice-button {
  padding: 10px 20px;
  font-size: 16px;
  background-color: #007aff;
  color: white;
  border: none;
  border-radius: 5px;
  cursor: pointer;
  transition: transform 0.3s ease, background-color 0.3s ease;
}

.nice-button:hover {
  background-color: #005bb5;
  transform: scale(1.05);
}

/* Overlay (page complète) */
.hidden-overlay {
  position: fixed;
  top: 0;
  left: 0;
  z-index: 10000;
  width: 100%;
  height: 100%;
  background-color: white;
  color: white;
  display: flex;
  justify-content: center;
  align-items: center;
  flex-direction: column;
  opacity: 0;
  visibility: hidden;
  transition: opacity 0.5s ease, visibility 0.5s ease;
}

.visible-overlay {
  opacity: 1;
  visibility: visible;
}

/* Bouton pour fermer l'overlay */
.close-button {
  position: absolute;
  top: 20px;
  right: 20px;
  font-size: 30px;
  color: black;
  background: none;
  border: none;
  cursor: pointer;
}

.overlay-content {
  text-align: center;
}

</style>

<script>
  document.addEventListener('DOMContentLoaded', function () {
    const body = document.querySelector('body');
    const overlay = document.getElementById('fullPageOverlay');

    body.appendChild(overlay);

    const openButton = document.getElementById('openPageButton');
    const closeButton = document.getElementById('closePageButton');

    // Montrer l'overlay
    openButton.addEventListener('click', function () {
      overlay.classList.add('visible-overlay');
    });

    // Cacher l'overlay
    closeButton.addEventListener('click', function () {
      overlay.classList.remove('visible-overlay');
    });
  });

  window.addEventListener('message', function (event) {
    if (event.origin !== 'https://frontend-configurateur-emws.vercel.app') {
      console.warn('Message non sécurisé ignoré.');
      console.log(event.origin)
      return;
    }

    console.log('Données JSON reçues de l\'iframe :', event.data);
    const closeButton = document.getElementById('closePageButton');
    closeButton.click();
    alert(`L'utilisateur a soumis les données et a choisi la marque: ${event.data.marque}`)
  });


</script>

{% schema %}
{
  "name": "Payment Icons",
  "target": "section",
  "settings": [
     {
          "type": "text",
          "id": "payment_text",
          "label": "Texte",
          "default": "Paiement sécurisé avec :"
        }
  ],
}
{% endschema %}
